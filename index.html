<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>SHIMYA CREW</title>
    
    <link rel="icon" href="/favicon.png" type="image/png">

    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    
    <style>
        /* 브라우저 높이 버그 방지 기본 세팅 */
        html, body {
            margin: 0;
            padding: 0;
            height: 100%;
        }

        body {
            margin: 0;
            background: black;
            /* height: 100vh;  <- 이거 대신 */
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            font-family: Helvetica, sans-serif;
            color: white;
            overflow: hidden;
        }

        /* 중앙 로고 */
        .logo {
            position: absolute;
            font-size: 18px;
            letter-spacing: 4px;
            cursor: pointer;
            text-decoration: none;
            color: white;
            transition: filter 0.4s ease, opacity 0.4s ease, text-shadow 0.4s ease;
        }

        /* 서랍 열릴 때 로고 블러 + 클릭 막기 */
        .logo.blur {
            filter: blur(1.8px);
            opacity: 0.85;
            text-shadow:
                0 0 6px rgba(255, 255, 255, 0.7),
                0 0 12px rgba(255, 255, 255, 0.5),
                0 0 22px rgba(255, 255, 255, 0.35);
            pointer-events: none;
        }

        /* 왼쪽 트리거 */
        .trigger-area {
            position: absolute;
            left: 32px;
            top: 50%;
            transform: translateY(-50%);
            width: 44px;
            height: 44px;
            cursor: pointer;
            z-index: 10;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* 트리거 점 - 기본은 빈 원 (hollow) + 숨쉬는 글로우 */
        .trigger-dot {
            width: 22px;
            height: 22px;
            border-radius: 50%;
            border: 2px solid white;      /* 테두리만 있는 빈 원 */
            background: transparent;       /* 안은 비어 있음 */
            transition:
                background 0.45s ease,
                transform 0.35s ease,
                border-width 0.35s ease,
                box-shadow 0.5s ease;
            animation: dotGlow 2.4s ease-in-out infinite alternate;
        }

        /* 서랍 열릴 때 점 애니메이션 멈추기 (글로우는 유지 가능) */
        .trigger-dot.paused {
            animation: none;
        }

        /* 채워진 상태(fill) – 탭 열렸을 때 */
        .trigger-dot.filled {
            background: white;
            border-width: 0;
            box-shadow: 0 0 15px rgba(255,255,255,0.85);
            transform: scale(1.15);
        }

        @keyframes dotGlow {
            0% {
                box-shadow: 0 0 0 rgba(255, 255, 255, 0.0);
                transform: scale(1);
            }
            50% {
                box-shadow: 0 0 18px rgba(255, 255, 255, 0.9);
                transform: scale(1.06);
            }
            100% {
                box-shadow: 0 0 6px rgba(255, 255, 255, 0.4);
                transform: scale(1.02);
            }
        }

        .trigger-area:active .trigger-dot {
            transform: scale(1.25);
            box-shadow: 0 0 12px rgba(255, 255, 255, 0.7);
        }

        /* ---------------------------- */
        /*      APPLE STYLE DRAWER     */
        /* ---------------------------- */
        .buttons {
            position: absolute;
            right: 40px;
            display: flex;
            flex-direction: column;
            gap: 28px;

            opacity: 0;
            transform: translateX(160px); /* 닫힌 위치 */

            padding: 28px 32px;

            border-radius: 34px / 42px;
            background: rgba(0, 0, 0, 0.78);
            border: 1px solid rgba(255, 255, 255, 0.10);
            backdrop-filter: blur(22px);

            /* 스프링 느낌 나는 커브 */
            transition:
                transform 0.55s cubic-bezier(0.22, 1.4, 0.32, 1),
                opacity 0.4s ease-out;
            
            box-shadow:
                0 25px 55px rgba(0, 0, 0, 0.65),
                0 0 35px rgba(255, 255, 255, 0.05);
        }

        /* Apple inner glow */
        .buttons::before {
            content: "";
            position: absolute;
            inset: -20px -10px;
            margin: auto;
            background: radial-gradient(
                circle at center,
                rgba(255, 255, 255, 0.18),
                transparent 70%
            );
            filter: blur(30px);
            z-index: -1;
        }

        .buttons.show {
            opacity: 1;
            transform: translateX(0);
        }

        /* 메뉴 아이템 */
        .menu-item {
            display: flex;
            align-items: center;
            justify-content: center;
            text-decoration: none;
        }

        .circle {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .circle span {
            color: white;
            font-size: 15px;
            letter-spacing: 1.4px;
            font-weight: 450;
            text-shadow: 0 0 4px rgba(0, 0, 0, 0.45);
        }

        #yellow { background: #FF9F00; }
        #blue   { background: #050536; }
        #red    { background: #D61F2C; }

        @media (max-width: 768px) {
            .circle {
                width: 140px;
                height: 140px;
            }

            .circle span {
                font-size: 14px;
            }

            .buttons {
                right: 24px;
                gap: 24px;
            }
        }

        /* iOS 최신 브라우저에서 실제 화면 높이 기준으로 맞추기 */
        @supports (height: 100dvh) {
            body {
                min-height: 100dvh;
            }
        }
    </style>
</head>
<body>

    <a href="logo.html" class="logo" id="logoText">SHIMYA CREW</a>

    <div class="trigger-area" id="triggerArea">
        <div class="trigger-dot" id="triggerDot"></div>
    </div>

    <!-- Apple Curve Drawer -->
    <div class="buttons" id="menuButtons">

        <a href="photos.html" class="menu-item">
            <div id="yellow" class="circle">
                <span>PHOTOS</span>
            </div>
        </a>

        <a href="writing.html" class="menu-item">
            <div id="blue" class="circle">
                <span>BLOG</span>
            </div>
        </a>

        <a href="contact.html" class="menu-item">
            <div id="red" class="circle">
                <span>CONTACT</span>
            </div>
        </a>

    </div>

    <script>
        const trigger = document.getElementById('triggerArea');
        const panel   = document.getElementById('menuButtons');
        const logo    = document.getElementById('logoText');
        const dot     = document.getElementById('triggerDot');

        let isOpen = false;

        // 드래그 관련 변수
        const CLOSED_X = 160;  // 닫힌 상태 X
        const OPEN_X   = 0;    // 열린 상태 X
        const DRAG_EDGE = 80;  // 오른쪽 가장자리 80px
        const DRAG_MAX  = 160; // 최대 드래그 거리
        const OPEN_THRESHOLD  = 0.4; // 40% 넘게 끌면 열림
        const CLOSE_THRESHOLD = 0.4; // 40% 넘게 밀면 닫힘

        let dragging = false;
        let dragStartX = null;
        let dragProgress = 0;

        function openDrawer() {
            if (isOpen) return;
            panel.style.transition = '';
            panel.style.transform  = '';
            panel.style.opacity    = '';
            panel.classList.add('show');
            logo.classList.add('blur');
            dot.classList.add('paused');   // 숨쉬는 애니메이션 정지
            dot.classList.add('filled');   // 빈 원 → 채워진 원
            isOpen = true;
        }

        function closeDrawer() {
            if (!isOpen && panel.classList.contains('show') === false) {
                panel.style.transition = '';
                panel.style.transform  = '';
                panel.style.opacity    = '';
                logo.classList.remove('blur');
                dot.classList.remove('paused');
                dot.classList.remove('filled');
                return;
            }
            panel.style.transition = '';
            panel.style.transform  = '';
            panel.style.opacity    = '';
            panel.classList.remove('show');
            logo.classList.remove('blur');
            dot.classList.remove('paused');
            dot.classList.remove('filled'); // 다시 빈 원으로 복귀
            isOpen = false;
        }

        /* 점 클릭으로 열고 닫기 */
        trigger.addEventListener('click', function (event) {
            event.stopPropagation();
            if (isOpen) {
                closeDrawer();
            } else {
                openDrawer();
            }
        });

        /* 바깥 클릭 시 닫기 */
        document.addEventListener('click', function () {
            if (isOpen) {
                closeDrawer();
            }
        });

        panel.addEventListener('click', function (event) {
            event.stopPropagation();
        });

        /* --------------------------------------------------
           오른쪽 → 왼쪽 드래그
           서랍이 손가락을 따라오다가, threshold 넘으면
           스프링 애니메이션으로 열리거나 닫힘
        -------------------------------------------------- */

        document.addEventListener('touchstart', function (e) {
            const touch = e.touches[0];
            const x = touch.clientX;
            const screenWidth = window.innerWidth;

            // 오른쪽 가장자리에서만 제스처 시작
            if (x > screenWidth - DRAG_EDGE) {
                dragging = true;
                dragStartX = x;
                dragProgress = 0;

                // 드래그 중에는 transition 끄고 직접 위치 제어
                panel.style.transition = 'none';

                // 드래그 시작하면서 서랍/로고 상태만 준비
                logo.classList.add('blur');
                dot.classList.add('paused');
            }
        });

        document.addEventListener('touchmove', function (e) {
            if (!dragging || dragStartX === null) return;

            const touch = e.touches[0];
            const currentX = touch.clientX;
            const diffX = currentX - dragStartX; // 오른쪽→왼쪽은 음수

            if (!isOpen) {
                // 열기: 오른쪽에서 왼쪽으로 끌기
                const dragDist = Math.min(Math.max(-diffX, 0), DRAG_MAX); // 양수로
                dragProgress = dragDist / DRAG_MAX;

                const currentTranslate = CLOSED_X - (CLOSED_X - OPEN_X) * dragProgress;
                panel.style.transform = `translateX(${currentTranslate}px)`;
                panel.style.opacity   = 0.1 + 0.9 * dragProgress;
            } else {
                // 닫기: 열린 상태에서 오른쪽으로 밀기
                const dragDist = Math.min(Math.max(diffX, 0), DRAG_MAX);
                dragProgress = dragDist / DRAG_MAX;

                const currentTranslate = OPEN_X + (CLOSED_X - OPEN_X) * dragProgress;
                panel.style.transform = `translateX(${currentTranslate}px)`;
                panel.style.opacity   = 1 - 0.9 * dragProgress;
            }
        });

        document.addEventListener('touchend', function () {
            if (!dragging) return;

            // 드래그 끝났을 때 threshold 기준으로 결정
            panel.style.transition = ''; // 스프링 애니메이션 다시 켜기

            if (!isOpen) {
                if (dragProgress > OPEN_THRESHOLD) {
                    openDrawer();
                } else {
                    closeDrawer();
                }
            } else {
                if (dragProgress > CLOSE_THRESHOLD) {
                    closeDrawer();
                } else {
                    openDrawer();
                }
            }
            dragging = false;
            dragStartX = null;
            dragProgress = 0;
        });
    </script>

</body>
</html>